<!DOCTYPE html>
<html lang="uz">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <title>Admin Paneli</title>
  <link rel="stylesheet" href="style.css" />
</head>
<body>
  <header>
    <h1 class="asd">Admin Paneli</h1>
    <a href="index.html" class="back-button">üè† Bosh sahifa</a>
  </header>

  <section class="admin-form">
    <input type="text" id="title" placeholder="Anime nomi" />
    <input type="text" id="link" placeholder="Telegram video linki" />
    <input type="text" id="img" placeholder="Anime rasmi (poster) URL" width="390" height="200" />
    <button onclick="addVideo()">Qo‚Äòshish</button>
  </section>

  <section class="admin-videos" id="adminVideoList"></section>

  <script>
    function loadVideos() {
      const videos = JSON.parse(localStorage.getItem("videos")) || [];
      const container = document.getElementById("adminVideoList");
      container.innerHTML = "";

      videos.forEach((video, index) => {
        const div = document.createElement("div");
        div.className = "video-item";
        div.innerHTML = `
          <img src="${video.img}" alt="${video.title}" width="100%">
          <h3>${video.title}</h3>
          <div class="btn-group">
            <button onclick="editVideo(${index})">‚úèÔ∏è Edit</button>
            <button onclick="deleteVideo(${index})">üóë O‚Äòchirish</button>
          </div>
        `;
        container.appendChild(div);
      });
    }

    function addVideo() {
      const title = document.getElementById("title").value.trim();
      const link = document.getElementById("link").value.trim();
      const img = document.getElementById("img").value.trim();

      if (!title || !link || !img) return alert("Barcha maydonlarni to‚Äòldiring!");

      const videos = JSON.parse(localStorage.getItem("videos")) || [];
      videos.push({ title, link, img });
      localStorage.setItem("videos", JSON.stringify(videos));

      document.getElementById("title").value = "";
      document.getElementById("link").value = "";
      document.getElementById("img").value = "";

      loadVideos();
    }

    function deleteVideo(index) {
      const videos = JSON.parse(localStorage.getItem("videos")) || [];
      videos.splice(index, 1);
      localStorage.setItem("videos", JSON.stringify(videos));
      loadVideos();
    }

    function editVideo(index) {
      const videos = JSON.parse(localStorage.getItem("videos")) || [];
      const updated = prompt("Yangi nom:", videos[index].title);
      if (updated) {
        videos[index].title = updated;
        localStorage.setItem("videos", JSON.stringify(videos));
        loadVideos();
      }
    }

    if (sessionStorage.getItem("auth") !== "true") {
      window.location.href = "admin-login.html";
    }

    window.onload = loadVideos;
  </script>
  
  <!-- <h1>Anime Qo‚Äòshish</h1>

  <input type="text" id="title" placeholder="Anime nomi"><br><br>
  <input type="text" id="image" placeholder="Rasm URL"><br><br>
  <input type="text" id="description" placeholder="Qisqacha mazmun"><br><br>
  <input type="text" id="link" placeholder="Ko‚Äòrish havolasi"><br><br>
  <button onclick="addAnime()">Qo‚Äòshish</button> -->

  <!-- Firebase SDK -->
  <script src="https://www.gstatic.com/firebasejs/9.22.0/firebase-app-compat.js"></script>
  <script src="https://www.gstatic.com/firebasejs/9.22.0/firebase-database-compat.js"></script>

  <script>
    const firebaseConfig = {
      apiKey: "AIzaSyBjS8OczjxZ0Cax-JfiErklZc24F3Fv0dc",
      authDomain: "cosmosdubbing.firebaseapp.com",
      databaseURL: "https://cosmosdubbing-default-rtdb.firebaseio.com",
      projectId: "cosmosdubbing",
      storageBucket: "cosmosdubbing.firebasestorage.app",
      messagingSenderId: "1088675177852",
      appId: "1:1088675177852:web:c0be3b73ff5994a18770f9",
      measurementId: "G-1FYXTQW6ZP"
    };

    firebase.initializeApp(firebaseConfig);
    const db = firebase.database();

    function addAnime() {
      const title = document.getElementById('title').value;
      const image = document.getElementById('image').value;
      const description = document.getElementById('description').value;
      const link = document.getElementById('link').value;

      const newAnimeRef = db.ref('anime').push();
      newAnimeRef.set({
        title,
        image,
        description,
        link
      }).then(() => {
        alert('Anime muvaffaqiyatli qo‚Äòshildi!');
        document.getElementById('title').value = '';
        document.getElementById('image').value = '';
        document.getElementById('description').value = '';
        document.getElementById('link').value = '';
      }).catch(error => {
        alert('Xatolik: ' + error.message);
      });
    }
  </script>
</body>
</html>
